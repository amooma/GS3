<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<chapter id="endgeraete" revision="$Revision$">
  <!--% Copyright (c) 2007 - amooma GmbH - http://www.amooma.de
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de-->

  <title>Endgeräte</title>

  <section id="snom-360">
    <title>Snom 360</title>

    <para><ulink
    url="http://www.snom.com/wiki/index.php/Snom360">http://www.snom.com/wiki/index.php/Snom360</ulink></para>

    <para>Das SIP-Telefon Snom 360 bietet neben den üblichen Zifferntasten,
    die auch bei analogen Geräten vorkommen, eine ganze Reihe nützlicher
    Funktionstasten, die bis zu einem gewissen Grad konfigurierbar sind. Die
    wichtigsten Funktionstasten werden an dieser Stelle kurz aufgeführt; eine
    genaue Beschreibung der Tasten finden Sie in dem über 100 Seiten starken
    Handbuch zu ihrem Snom-Telefon.</para>

    <variablelist>
      <varlistentry>
        <term>4 Soft-Tasten unter dem Bildschirm</term>

        <listitem>
          <para>Diese Tasten werden mit kontextabhängigen Funktionen belegt,
          diese werden in der untersten Zeile des Displays angezeigt.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>- Volume +</term>

        <listitem>
          <para>Verändert die Lautstärke des Lautsprechers oder Hörers</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Mute</term>

        <listitem>
          <para>Schaltet das Mikrofon aus oder ein.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Speaker</term>

        <listitem>
          <para>Schaltet Lauthören aus oder ein.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Headset</term>

        <listitem>
          <para>Schaltet den Kopfhörer aus oder ein.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>x</term>

        <listitem>
          <para>Abbrechen - Gespräch beenden.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Richtungstasten</term>

        <listitem>
          <para>Werden zur Navigation im Menü verwendet</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>&#8730;</term>

        <listitem>
          <para>Bestätigen - Wählen - Gespräch annehmen.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Retrieve</term>

        <listitem>
          <para>Abfragen der Mailbox.</para>

          <para>Hat die Mailbox ein Gespräch für Sie aufgezeichnet, wird dies
          durch Blinken der Message-LED signalisiert. Die Anzahl alter und
          neuer Nachrichten wird zusätzlich auch auf dem Display
          angezeigt.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Redial</term>

        <listitem>
          <para>Wahlwiederholung</para>

          <para>Durch Drücken dieser Taste können Sie die letzten angerufenen
          Nummern erneut anrufen und sehen angenommene und verpaßte Anrufe.
          Wählen Sie zunächst mit den Pfeiltasten die Nummer aus und drücken
          danach die <emphasis role="bold">&#8730;</emphasis> Taste.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Settings</term>

        <listitem>
          <para>Öffnet das Konfigurationsmenü.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Directory</term>

        <listitem>
          <para>Öffnet das Telefonbuch.</para>

          <para>Belegt mit dem Firmen-Telefonbuch. Such-Modus ähnlich dem
          bekannten "T9", also z.B. <literal>63437</literal> für
          <literal>MEIER</literal> eintippen. (Technisch hat die Suche nichts
          mit T9 gemeinsam. Während bei T9 Wörterlisten zum Einsatz kommen
          wird hier bei Eingabe von z.B. <literal>63437</literal> nach
          passenden Treffern für das Suchmuster
          <literal>[MNO][DEF][GHI][DEF][PQRS]</literal> gesucht.)</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Menu</term>

        <listitem>
          <para>Öffnet das Hauptmenü des Telefons.</para>

          <para>Das Hauptmenü enthält Untermenüs zur Einstellung der
          Klingeltöne, Displaykontrast etc.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Transfer</term>

        <listitem>
          <para>Verbindet den Anrufer mit einer anderen Nummer.</para>

          <para>Es gibt mehrere Wege, wie Sie Ihren Gesprächspartner mit einer
          anderen Nummer verbinden können:</para>

          <variablelist>
            <varlistentry>
              <term>direktes Verbinden</term>

              <listitem>
                <para>Wenn Sie diese Taste während eines Gesprächs drücken,
                wird Ihr Gesprächspartner auf Halten gesetzt. Geben Sie danach
                die Nummer an, mit der Sie den Anrufer verbinden möchten.
                Durch Drücken der Taste &#8730; wird der Teilnehmer dann mit
                der gewählten Nummer verbunden.</para>
              </listitem>
            </varlistentry>

            <varlistentry>
              <term>Verbinden mit Rückfrage</term>

              <listitem>
                <para>Drücken Sie hierzu während eines Gesprächs die Taste
                <emphasis role="bold">Hold</emphasis> um Ihren
                Gesprächspartner zu halten und wählen dann die Nummer, mit der
                Sie ihn verbinden möchten. Sie können jetzt mit dem zweiten
                Teilnehmer ein Gespräch führen, welches durch Drücken der
                Taste <emphasis role="bold">Transfer</emphasis> oder durch
                Auflegen des Hörers mit dem ersten Teilnehmer verbunden
                wird.</para>
              </listitem>
            </varlistentry>
          </variablelist>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Hold</term>

        <listitem>
          <para>Gespräch halten.</para>

          <para>Wenn Sie diese Taste während eines Gesprächs drücken, wird Ihr
          Gesprächspartner auf Halten gesetzt. Danach können Sie eine weitere
          Verbindung zu einem anderen Teilnehmer herstellen.</para>

          <para>Sie können das Gespräch durch Drücken der Soft-Taste unter der
          Bezeichnung <emphasis role="bold">R</emphasis> (auf dem Display)
          wieder heranholen. Sie können auch mehrere Gespräche so halten, um
          ein bestimmtes Gespräch heranzuholen wählen Sie es zunächst mit den
          Pfeiltasten aus und drücken danach die Taste <emphasis
          role="bold">R</emphasis>.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>DND</term>

        <listitem>
          <para>Schaltet den <quote>Nicht-Stören</quote>-Modus ein/aus.</para>

          <para>Wenn dieser Modus aktiviert ist, werden keine Anrufe zu dem
          Telefon durchgestellt. Dabei wird auf dem Display "Inaktiv"
          angezeigt.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>12 Programmierbare Funktionstasten</term>

        <listitem>
          <para>Das Telefon besitzt 12 Funktionstasten, die für
          unterschiedliche Funktionen programmierbar sind, z.B.:</para>

          <variablelist>
            <varlistentry>
              <term>Leitung</term>

              <listitem>
                <para>Eine SIP-Leitung kann auf diese Funktionstaste gelegt
                werden. Bei einem eingehenden Gespräch auf dieser Leitung
                leuchtet die entsprechende LED neben der Taste auf. Durch
                Drücken dieser Taste kann das Gespräch angenommen
                werden.</para>

                <para>Während eines bestehenden Gesprächs leuchtet die LED
                konstant. Durch Drücken der Taste kann das Gespräch auf Halten
                gesetzt werden.</para>

                <para>Man kann auch z.B. während eines Gespräches auf eine
                andere freie Leitungstaste drücken um ein gleichzeitiges
                zweites Gespräch auf einer 2. Leitung zu beginnen. Auch Hin-
                und Her-Schalten (Makeln) ist möglich.</para>
              </listitem>
            </varlistentry>

            <varlistentry>
              <term>Ziel</term>

              <listitem>
                <para>Eine Nummer kann hinterlegt werden, die bei Drücken
                dieser Taste angerufen wird.</para>
              </listitem>
            </varlistentry>

            <varlistentry>
              <term>DTMF</term>

              <listitem>
                <para>Eine beliebige DTMF-Sequenz kann hinterlegt werden, die
                bei Drücken auf die Taste gesendet wird.</para>
              </listitem>
            </varlistentry>
          </variablelist>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>

  <section id="siemens-openstage">
    <title>Siemens OpenStage</title>
    <para>
      Welche Schritte genau nötig sind, um das Provisioning für das Openstage 
      zu installieren wird ausführlich in der Datei INSTALL.txt erläutert. 
      Diese findet man in der jeweiligen Gemeinschafts-Distribution im 
      /opt/gemeinschaft-siemens/doc Verzeichnis.
    </para>

    <para>Reboot: Per Konfigurations-Taste in den Reiter <quote>Menü</quote>
    schalten und dann gleichzeitig die Tasten <literal>1</literal>,
    <literal>4</literal>, <literal>7</literal> gedrückt halten. Ggf.
    Reboot-Paßwort (= Admin-Paßwort?) eingeben. Bildschirm wird kurz grün,
    dann rebootet<footnote>
        <para>Der Bootloader ist übrigens U-Boot. <ulink
        url="http://sourceforge.net/projects/u-boot">http://sourceforge.net/projects/u-boot</ulink>,
        <ulink
        url="http://wiki.tuxbox.org/Bootloader#U-Boot.2FPPCBoot">http://wiki.tuxbox.org/Bootloader#U-Boot.2FPPCBoot</ulink></para>
      </footnote> das Telefon.</para>

    <para>Das Admin-Paßwort ist per Default <literal>123456</literal> (oder
    <literal>000000</literal>?).</para>
    <para>Das Factory-Reset-Paßwort ist per Default <literal>124816</literal></para>
  </section>

<!--<![CDATA[
<section id="siemens-openstage-prov-installation">
   <title>Siemens OpenStage Provisioning Installieren</title>
    <para>Voraussetzungen:</para>
      <para>- Gemeinschaft installiert</para>
      <para>- DHCP-Server Mass-Deployment für Siemens-Telefone konfiguriert</para>
    

    <para>Installation:</para>
    <para>Verzeichnis /opt/gemeinschaft-siemens/ installieren (sollte dann
      z.B. die Dateien prov-settings.php und prov-checkcfg.php enthalten)
    </para>
    <para>Entwickler:
      <screen>
	cd /opt/
	ln -s gemeinschaft-siemens-svn/opt/gemeinschaft-siemens gemeinschaft-siemens
      </screen>
    </para>
      
    <para>
      In der <filename>/etc/php.ini</filename> (bzw. <filename>/etc/php5/apache2/php.ini</filename>) sollte der Paramter
      <command>always_populate_raw_post_data = On</command> gesetzt werden.

      Dann sollte SSL für den Apache installiert werden:
      <command>yum install openssl mod_ssl</command>
      Bzw. auf Debian:
      <command>apt-get install openssl</command>

      Damit der Apache-Server auch SSL benutzt, müssen die Module noch aktiviert werden:
      Bei CentOS in <filename>/etc/httpd/conf.d/ssl.conf</filename>
      <command>LoadModule ssl_module modules/mod_ssl.so</command>
      
      Unter Debian:
      <screen>
      cd /etc/apache2/mods-enabled/                           
      ln -s ../mods-available/ssl.load ssl.load               
      ln -s ../mods-available/ssl.conf ssl.conf               
      ln -s ../mods-available/rewrite.load rewrite.load       
      </screen>

      Als nächstes muss man die selbst-signierten SSL-Schlüssel generieren und die Dateien ggf. in
      die Apache-Konfig-Verzeichnisse (z.B. <filename>/etc/httpd/conf/ssl.*/</filename>) legen.
      (Möglicherweise sind mit mod_ssl bereits Keys installiert.)         
</para>
<para>
<screen>
>     SSLCertificateFile      /etc/httpd/conf/ssl.crt/10_128_131_30.crt
>     SSLCertificateKeyFile   /etc/httpd/conf/ssl.key/server.key       
>     SSLCertificateChainFile /etc/httpd/conf/ssl.crt/10_128_131_30.ca-bundle
>     SSLCACertificateFile    /etc/httpd/conf/ssl.crt/10_128_131_30.ca-bundle
</screen>

Falls in den o.g. Verzeichnissen schon Dateien liegen, dann
sind die direkt beim Apache-Paket mitinstalliert worden,   
müßten also dann (wenn sie funktionieren) nicht noch generiert
werden. Sollten Keys vorinstalliert sein, dann heißen die     
üblicherweise server.key, server.crt, server.ca-bundle o.ä.   

Falls die Dateien dort nicht liegen, muss man die Schlüssel also von Hand erstellen:

Privaten RSA-Schlüssel erzeugen:
<screen>
$<command> cd /etc/httpd/conf/</command>
(Debian: <command>cd /etc/apache2/ &amp;&amp; mkdir ssl &amp;&amp; cd ssl/</command>)     
$ <command>openssl genrsa -out ssl.key/my-server.key 1024</command>
(Debian: <command>openssl genrsa -out my-server.key 1024</command>)
Generating RSA private key, 1024 bit long modulus      
..........++++++                                       
.....................................++++++            
e is 65537 (0x10001)                                   
</screen>
CSR (Certificate Signing Request) erzeugen:
<screen>
$<command>openssl req -new \                                   
  -key ssl.key/my-server.key \                         
  -out ssl.csr/my-server.csr</command>
(Debian: <command>openssl req -new -key my-server.key -out my-server.csr</command>)
You are about to be asked to enter information that will be incorporated
into your certificate request.                                          
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank                  
For some fields there will be a default value,                             
If you enter '.', the field will be left blank.                            
-]]>--><!--<![CDATA[-]]>--><!--<![CDATA[-]]>--><!--<![CDATA[-]]>--><!--<![CDATA[-
Country Name (2 letter code) [GB]:DE
State or Province Name (full name) [Berkshire]:Nordrhein-Westfalen
Locality Name (eg, city) [Newbury]:Münster
Organization Name (eg, company) [My Company Ltd]:LVM Versicherungen
Organizational Unit Name (eg, section) []:.
Common Name (eg, your name or your server's hostname) []:192.168.1.130
Email Address []:.

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:.
An optional company name []:.
</screen>
Wichtig: Dabei gibt man als "Common Name" die IP-Adresse des Rechners an!

CSR Überprüfen (optional):
<screen>
$<command>openssl req -noout -text -in ssl.csr/my-server.csr</command>
Certificate Request:
    Data:
        Version: 0 (0x0)
        Subject: C=DE, ST=Nordrhein-Westfalen, L=Münster, O=LVM
Versicherungen, CN=192.168.1.130
[...]
</screen>
Selbst-signiertes Zertifikat erstellen:
<screen>
$ <command>openssl x509 -req -days 3650 \
  -in ssl.csr/my-server.csr \
  -signkey ssl.key/my-server.key \
  -out ssl.crt/my-server.crt</command>
(Debian:
<command>openssl x509 -req -days 3650 \
  -in my-server.csr \
  -signkey my-server.key \
  -out my-server.crt</command>
)
Signature ok
subject=/C=DE/ST=Nordrhein-Westfalen/L=Münster/O=LVM
Versicherungen/CN=192.168.1.130
Getting Private key
</screen>
Eintragen in der entsprechenden Virtual-Host-Definition im Apache (Die Parameter SSLCertificateChainFile und SSLCACertificateFile
braucht man dann nicht.):
<screen>
  SSLCertificateFile      /etc/httpd/conf/ssl.crt/my-server.crt
  SSLCertificateKeyFile   /etc/httpd/conf/ssl.key/my-server.key
</screen>  

</para>
  <para>   
      Virtuellen Host in Apache anlegen:
      <screen>
      <command>vim /etc/httpd/sites-available/siemens </command>
      Debian: <command>vim /etc/apache2/sites-available/siemens </command>
      </screen>
      <screen>
      Listen 18443

      &lt;VirtualHost *:18443&gt;
        SSLEngine on

        SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP
        #SSLCipherSuite !ADH:!EXPORT56:RC4+RSA:RC4+SHA
        # without EDH (Ephemeral Diffie-Hellman) because it's a symmetric
        # cipher and thus cannot be decrypted (e.g. by WireShark) even if
        # the private key of the server is known, so RSA is better for
        # debugging

        # Debian
        SSLCertificateFile      /etc/apache2/ssl/openstage-crt.pem
        SSLCertificateKeyFile   /etc/apache2/ssl/openstage-key.pem

        # RedHat
        #SSLCertificateFile      /etc/httpd/ssl/openstage-crt.pem
        #SSLCertificateKeyFile   /etc/httpd/ssl/openstage-key.pem

        #CustomLog logs/ssl_request_log \
        #    "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"

        DocumentRoot /opt/gemeinschaft/htdocs/prov/siemens

        # KeepAlive ist absolutely necessary!
        KeepAlive On
        MaxKeepAliveRequests 100
        KeepAliveTimeout 45
        # KeepAliveTimeout not below 30 (seconds)!

        &lt;Directory /&gt;
                Options FollowSymLinks MultiViews Indexes
        &lt;/Directory&gt;
        &lt;IfModule mod_rewrite.c&gt;
                RewriteEngine on
                RewriteRule ^/ringtones/  - [L]
                RewriteRule ^/(.*)$ /settings.php?_url=$1 [L,QSA]
        &lt;/IfModule&gt;
        &lt;IfModule mod_headers.c&gt;
                Header unset X-Powered-By
                Header unset X-Pad
                Header unset X-Cache
                #Header unset Connection
        &lt;/IfModule&gt;
        &lt;IfModule mod_cache.c&gt;
                CacheDisable /
        &lt;/IfModule&gt;
    &lt;/VirtualHost&gt;
      </screen>
      
      Dannach muss die Seite noch aktiviert werden:
      <command>a2ensite siemens</command>

      Nachdem apache nun neu gestartet wird, sollte die Seite verfügbar sein:
      <screen>
      <command>/etc/init.d/httpd restart</command>
      <command>(Debian: /etc/init.d/apache2 restart)</command>
    </screen>
      Man kann mit einem Browser überprüfen, ob die Seite verfügbar ist (https://ip-des-servers:18443)
    
      Zum Debuggen kann man außerdem das <filename>siemens-access-debug.log</filename> aktivieren:
      <screen>
      <command>cd /var/log/gemeinschaft/</command>
      <command>touch siemens-access-debug.log</command>
      <command>chown apache:apache siemens-access-debug.log</command>
      (Debian: <command>chown www-data:www-data siemens-access-debug.log</command>)
      </screen>
      In der <filename>/opt/gemeinschaft-siemens/prov-settings.php</filename>zum Debuggen
      des Protokolls $raw_debug auf true setzen (Achtung, die Datei siemens-access-debug.log
      wird schnell recht groß!), ansonsten immer auf false.
      </para>
      <para>
      Nun sollte das Provisioning laufen, wenn man Firmware-Updates, Klingeltöne, Logos oder 
      Bildschirmhintergründe für das OpenStage Provisionieren möchte, dann muss man noch einen 
      FTP-Server einrichten:
      <screen>
	<command>yum install vsftpd</command>
	(Debian: <command>apt-get install vsftpd</command>
      </screen>
      <footnote><para>
      Für Debian gibt es auch eine Vielzahl anderer FTP-Server als Pakete:
      ftpd, inetutils-ftpd, muddleftpd, proftpd, pure-ftpd, twoftpd,
      twoftpd-run, vsftpd, wu-ftpd, wzdftpd, ...) </para>
      </footnote>
       
      Wenn der FTP-Server installiert wurde, muss man noch einen User für die Dateien hinzufügen:
      <screen>
      <command>useradd -M -d /opt/gemeinschaft-siemens/firmware/ -g nobody -n -s /sbin/nologin gs-siemens-fw</command>
      <command>(Debian: useradd -d /opt/gemeinschaft-siemens/firmware/ -g nogroup -s /bin/sh gs-siemens-fw)</command>
      </screen>
      
      Dannach muss man noch für den gerade angelegten Benutzer das Passwort setzen:
      <screen>
      <command>passwd gs-siemens-fw</command>
      (interaktive Eingabe - in /opt/gemeinschaft-siemens/conf.php
      (GS_PROV_SIEMENS_FTP_PWD) eintragen!)
      </screen>

      Jetzt muss noch der vsftpd ansich Konfiguriert werden dies geschieht in der 
      <filename>/etc/vsftpd/vsftpd.conf</filename> (Debian: <filename>/etc/vsftpd.conf</filename>):
      <screen>
      ascii_upload_enable=NO
      ascii_download_enable=NO
      anonymous_enable=NO
      anon_upload_enable=NO
      anon_mkdir_write_enable=NO
      local_enable=YES
      write_enable=NO
      userlist_enable=YES
      userlist_file=/etc/vsftpd.user_list
      userlist_deny=NO
      chroot_local_user=YES
      chroot_list_enable=NO
      </screen>
      Dann muss der user(gs-siemens-fw) noch in <filename>/etc/vsftpd.user_list</filename> eingetragen werden.
      Wenn alles Konfiguriert ist, kann man den FTP-Server beim Systemstart mitstarten lassen:
      <screen>
      <command>chkconfig -]]>--><!--<![CDATA[-levels 235 vsftpd on</command>
      <command>(Debian: update-rc.d vsftpd defaults)</command>
      </screen>
      Und zum schluss den FTP-Server noch per Hand starten:
      <command>/etc/init.d/vsftpd restart</command>

    </para>
  </section>
]]>-->
</chapter>